var FormWizard=function(){return{init:function(){if(jQuery().bootstrapWizard){var t=$("#submit_form"),e=$(".alert-danger",t),a=$(".alert-success",t);t.validate({doNotHideMessage:!0,errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,rules:{select_cat:{required:!0,min:0},select_name:{required:!0},addInfo:{required:!0},apiURL:{required:!0},tblID:{required:!0}},errorPlacement:function(t,e){"gender"==e.attr("name")?t.insertAfter("#form_gender_error"):"payment[]"==e.attr("name")?t.insertAfter("#form_payment_error"):t.insertAfter(e)},invalidHandler:function(t,e){bsTips("请检查输入数据的有效性")},highlight:function(t){$(t).closest(".form-group").removeClass("has-success").addClass("has-error")},unhighlight:function(t){$(t).closest(".form-group").removeClass("has-error")},success:function(t){"gender"==t.attr("for")||"payment[]"==t.attr("for")?(t.closest(".form-group").removeClass("has-error").addClass("has-success"),t.remove()):t.addClass("valid").closest(".form-group").removeClass("has-error").addClass("has-success")},submitHandler:function(t){bsTips("数据有效性校验通过")}});var s=function(t,e,a){var s=e.find("li").length,n=a+1;$(".step-title",$("#form_wizard_1")).text("第 "+(a+1)+" 步，共 "+s+" 步"),jQuery("li",$("#form_wizard_1")).removeClass("done");for(var o=e.find("li"),l=0;a>l;l++)jQuery(o[l]).addClass("done");switch(n){case 1:$("#form_wizard_1").find(".button-previous").hide(),$("#form_wizard_1").find(".button-next").show(),$(".mt-step-col:nth(0)").removeClass("done").addClass("active"),$(".mt-step-col:nth(1)").removeClass("active").removeClass("done"),$("#tab2 a.btn-circle:gt(0)").length>0&&$(".fa-minus").parent().parent().remove();break;case 2:$("#tab2 a.btn-circle:gt(0)").length>0?$("#form_wizard_1").find(".button-next").show():$("#form_wizard_1").find(".button-next").hide(),$(".mt-step-col:nth(1)").addClass("active"),$(".mt-step-col").first().removeClass("active"),$(".mt-step-col").first().addClass("done"),$("#form_wizard_1").find(".button-submit").hide(),$("#form_wizard_1").find(".button-previous").show(),$(".mt-step-col:nth(2)").removeClass("active").removeClass("done"),$("select[name='preview']").html($("select[name='select_name']").html()),$('div[name="addList"]').remove();break;case 3:$("#form_wizard_1").find(".button-next").hide(),$("#form_wizard_1").find(".button-submit").show(),$(".mt-step-col:nth(1)").removeClass("active"),$(".mt-step-col:nth(1)").addClass("done"),$(".mt-step-col").last().addClass("active");var i,r,c=parseInt($("select[name='select_name'] option").last().val(),10)+1,d=$('#tab2 input[name="addInfo"]').length,m="",p="";for(m+='     <label class="control-label col-md-2 font-blue bold">序号</label>',m+='     <div class="col-md-2">',m+='         <p class="form-control-static font-blue bold">值</p>',m+="     </div>",m+='     <div class="col-md-2">',m+='         <p class="form-control-static font-blue bold">列表项</p>',m+="     </div>",$("#tab3 .form-group").last().html(m),m="","0"===$("select[name='select_cat']").val()&&(m+='     <div class="col-md-3">',m+='         <p class="form-control-static font-blue bold">接口地址</p>',m+="     </div>",m+='     <div class="col-md-2">',m+='         <p class="form-control-static font-blue bold">表单ID</p>',m+="     </div>",$("#tab3 .form-group").last().append(m),m=""),l=0;d>l;l++)i=$('#tab2 input[name="addInfo"]:nth('+l+")").val(),val=l+c,r=l+1,m+='<div class="form-group" name="addList">',m+='    <label class="control-label col-md-2">'+r+"</label>",m+='           <div class="col-md-2">',m+='              <p class="form-control-static">'+val+"</p>",m+="           </div>",m+='           <div class="col-md-2">',m+='              <p class="form-control-static">'+i+"</p>",m+="            </div>","0"===$("select[name='select_cat']").val()&&(url=$('#tab2 input[name="apiURL"]:nth('+l+")").val(),tblID=$('#tab2 input[name="tblID"]:nth('+l+")").val(),m+='           <div class="col-md-3">',m+='              <p class="form-control-static">'+url+"</p>",m+="           </div>",m+='           <div class="col-md-2">',m+='              <p class="form-control-static">'+tblID+"</p>",m+="            </div>"),m+="</div>",p+='<option value="'+val+'">'+i+"</option>";d&&($("select[name='preview']").append(p),$("#tab3").last().append(m))}App.scrollTo($(".page-title"))};$("#form_wizard_1").bootstrapWizard({nextSelector:".button-next",previousSelector:".button-previous",onTabClick:function(n,o,l,i){return a.hide(),e.hide(),t.valid()===!1?!1:void s(n,o,i)},onNext:function(n,o,l){return a.hide(),e.hide(),t.valid()===!1?!1:void s(n,o,l)},onPrevious:function(t,n,o){a.hide(),e.hide(),s(t,n,o)},onTabShow:function(t,e,a){var s=e.find("li").length,n=a+1,o=n/s*100;$("#form_wizard_1").find(".progress-bar").css({width:o+"%"})}}),$("#form_wizard_1").find(".button-previous").hide(),$("#form_wizard_1 .button-submit").click(function(){var t,e,a,s=getRootPath()+"/DataInterface/insert",n={},o=$('div[name="addList"]').length;"0"===$("select[name='select_cat']").val()?(e="Value",a="Name",n.tbl=TBL.SELECT):(t=$('select[name="preview"]'),e=t.data("ID"),a=t.data("Name"),n.tbl=$('select[name="select_cat"]').find("option:selected").data("tblID")),n.utf2gbk=[a];for(var l=0;o>l;l++)t=$('div[name="addList"]:nth('+l+")"),n[e]=t.find("p:nth(0)").text(),n[a]=t.find("p:nth(1)").text(),"0"===$("select[name='select_cat']").val()&&(n.apiURL=t.find("p:nth(2)").text(),n.tblID=t.find("p:nth(3)").text()),$.post(s,n,function(t,e){if("success"==e){var a=$.parseJSON(t);bsTips(a.message,a.type)}else infoTips("保存设置失败，请稍后重试或联系管理员!",0),infoTips(JSON.stringify(t))});$(".button-previous").click(),$(".button-previous").click(),handleSelect2.init()}).hide()}}}}(),handleSelect2=function(){function t(){var t=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=34&M=3",e=ReadData(t);InitSelect("select_cat",e);var a=1;e.data.map(function(t){$("select[name='select_cat'] option:nth("+a+")").data("apiUrl",t[2]),$("select[name='select_cat'] option:nth("+a+")").data("tblID",t[3]),a++})}return $(document).on("change",'select[name="select_cat"]',function(){if(!($(this).val()<0)){var t=getRootPath(1)+"/"+$(this).find("option:selected").data("apiUrl"),e=getRootPath(1)+"/"+$(this).find("option:selected").data("tblID"),a=ReadData(t),s=$(this).find("option:selected").text();if(InitSelect("select_name",a),InitSelect("preview",a),$(this).val()>0){var n=$('select[name="preview"]');n.data("ID",a.header[0].title),n.data("Name",a.header[1].title)}$("select[name='select_name']").data("tblID",e),$('span[name="selectName"]').text(s),$('#tab3 p[data-display="select_cat"]').text(s),$("a.button-next").click()}}),$("#tab2 a.btn-circle:nth(0)").on("click",function(){$("#form_wizard_1").find(".button-next").show();var t='<div class="form-group">';t+='    <label class="control-label col-md-3">待增加项',t+='         <span class="required"> * </span>',t+="     </label>",t+='     <div class="col-md-2">',t+='         <input type="text" class="form-control" name="addInfo"/>',t+='         <span class="help-block"> 输入待增加项描述 </span>',t+="     </div>","0"===$("select[name='select_cat']").val()&&(t+='     <div class="col-md-3">',t+='         <input type="text" class="form-control" name="apiURL"/>',t+='         <span class="help-block"> 输入接口地址 </span>',t+="     </div>",t+='     <div class="col-md-2">',t+='         <input type="text" class="form-control" name="tblID"/>',t+='         <span class="help-block"> 表单ID </span>',t+="     </div>"),t+='     <a href="javascript:;" class="btn btn-circle btn-icon-only red">',t+='         <i class="fa fa-minus"></i>',t+="     </a>",t+=" </div>",$("#tab2").append(t)}),$(document).on("click","#tab2 a.btn-circle:gt(0)",function(){$(this).parent().remove()}),{init:function(){t()}}}();jQuery(document).ready(function(){initDom(),UIIdleTimeout.init(),FormWizard.init(),handleSelect2.init()}),jQuery(window).resize(function(){HeadFix()});
//# sourceMappingURL=settings.min.js.map